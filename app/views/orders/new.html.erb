<head>
<style>
img {
  float: left; padding-right: 50px;
}
h1 {text-align: center;}
h2 {text-align: center;}
h4 {text-align: center;}

.sidenav-ordersummary {
  margin-top: 100px; /* Stay away from top navbar */
  position: fixed;
  z-index: 1;
  top: 20px;
  right: 40px; /* side bar to the right of screen */
  background: #eee;
  overflow-x: hidden;
}

.main {
  margin-right: 120px; /* Same width as the sidebar + right position in px */
  font-size: 16px; /* Increased text to enable scrolling */
  padding: 20px 20px;
}

</style>
</head>
<body>
<div>


<div class="main">
<h1> Checkout</h1>
 <hr class="solid"> 
<%= form_with model: @order, url: orders_path, method: :post, local: true, scope: :order do |f| %> 
  <hr class="solid"> 
  
   <h2> Shipping Address</h2>
   <% invalid = @order.errors.include?(:email) %> 
    <div class="form-group"> <!-- class -->
    <%= f.label :Electronic_Delivery%><br>
    <%= f.email_field :email, class: "form-control #{'is-invalid' if invalid}" %>
    <% if invalid %>
        <div class="invalid-feedback d-block">
          <% @order.errors.full_messages_for(:email).each do |error_message| %>
            <%= error_message %>.
          <% end %>
        </div>
      <% end %>
    </div> <!-- class -->
  <hr class="solid"> 

  <h2> Billing Information</h2>
  <% invalid = @order.errors.include?(:credit_card_number) %> 
  <div class="form-group"> <!-- class -->
    <%= f.label :card_number%><br>
    <%= f.text_field :credit_card_number, class: "form-control #{'is-invalid' if invalid}"%>
      <% if invalid %>
        <div class="invalid-feedback d-block">
          <% @order.errors.full_messages_for(:credit_card_number).each do |error_message| %>
            <%= error_message %>.
          <% end %>
        </div>
      <% end %>
  </div> <!-- class -->
  
  <% invalid = @order.errors.include?(:exp_month) %> 
  <div class="form-group">
    <%= f.label :Expiration_date %><br>
    <%= f.select :exp_month, 1..12, class: "form-control #{'is-invalid' if invalid}"%>
      <% if invalid %>
        <div class="invalid-feedback d-block">
          <% @order.errors.full_messages_for(:exp_month).each do |error_message| %>
            <%= error_message %>.
          <% end %>
        </div>
      <% end %>
    <%= f.select :exp_year, Date.today.year.. 8.years.from_now.year %>
    <!-- <%= f.month_field :exp_date, class: "form-group" %> --> 
  </div>

  <% invalid = @order.errors.include?(:security_code) %> 
  <div class="form-group">
    <%= f.label :Security_Code %><br>
    <%= f.text_field :security_code, class: "form-control #{'is-invalid' if invalid}"%>
      <% if invalid %>
        <div class="invalid-feedback d-block">
          <% @order.errors.full_messages_for(:security_code).each do |error_message| %>
            <%= error_message %>.
          <% end %> 
        </div>
      <% end %>
  </div>

  <hr class="solid">

  <div class="card-header bg-light text-dark">
        <h2> Delivered Electronically </h2>
  </div>
  <div class="card-body">
    <%current_cart.cart_items.each do |item| %>
        <%= link_to image_tag(item.book.assetlabel, height: 150)%><br></p> 
        <div class="container">
          <h4><%= item.book.title%></h4>
          <p>By <%= item.book.author %></p>
          <h6><%= item.book.genre %> | <%= number_to_currency(item.book.price)%> </h6>
          <p>Subtotal: <%= number_to_currency(item.total) %></p>
        <br>
        </div> <!-- container -->
    <% end %> <!-- each do cart items-->
  <div class="card-footer">
</div> <!-- main -->

<!-- Side navigation -->
<div class="sidenav-ordersummary">
<div class="card-header bg-light text-dark">
<div class="pull-right" style="margin: 10px">
    <div class="pull-right" style="margin: 5px">
      <h4> Order Summary </h4> 
      <hr class="solid">
      <p>
         Subtotal: <b><%= number_to_currency(current_cart.subtotal)%></b>
      </p>
      <p>
         Estimated Shipping: <b>Free</b>
      </p>
      <p>
         Tax (Included in Item Price): <b>$0.00</b>
      </p>
      <p>
         ____________________________
      </p>
      <h5> Order Total: <%= number_to_currency(current_cart.subtotal) %></h5> 
      <%= f.submit "Place Order", class: "btn btn-block btn-primary"%><br> 
   </div>
</div>
</div>
</div> <!-- sidebar -->
<% end %>